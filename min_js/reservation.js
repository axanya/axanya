function showRemaining(){var e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()).getTime(),a=end-t;if(0>a)return clearInterval(timer),document.getElementById("countdown_2").innerHTML="Expired!",document.getElementById("countdown_1").innerHTML="Expired!",void(window.location.href=APP_URL+"/reservation/expire/"+$("#reservation_id").val());var n=(Math.floor(a/_day),Math.floor(a%_day/_hour)),o=Math.floor(a%_hour/_minute),i=Math.floor(a%_minute/_second);document.getElementById("countdown_2").innerHTML=n+":",document.getElementById("countdown_2").innerHTML+=o+":",document.getElementById("countdown_2").innerHTML+=i+"",document.getElementById("countdown_1").innerHTML=n+":",document.getElementById("countdown_1").innerHTML+=o+":",document.getElementById("countdown_1").innerHTML+=i+""}var uri_segment=function(e){if(""==e)return{};for(var t={},a=0;a<e.length;++a){var n=e[a].split("=",2);1==n.length?t[n[0]]="":t[n[0]]=decodeURIComponent(n[1].replace(/\+/g," "))}return t}(window.location.search.substr(1).split("&"));if(1!=uri_segment.visited){var end=new Date(document.getElementById("expired_at").value).getTime(),_second=1e3,_minute=60*_second,_hour=60*_minute,_day=24*_hour,timer;timer=setInterval(showRemaining,1e3),$(document).ready(function(){$("[id$='-trigger']").click(function(){var e="#"+$(this).attr("id").replace("-trigger","");$("#reserve_id").val(e),$(e).removeClass("hide"),$(e).addClass("show"),$(e).attr("aria-hidden","false")}),$('[data-behavior="modal-close"]').click(function(e){e.preventDefault(),$(".modal").removeClass("show"),$(".modal").attr("aria-hidden","true")}),$("#decline_reason").change(function(){"other"==$(this).val()&&($("#decline_reason_other_div").removeClass("hide"),$("#decline_reason_other_div").addClass("show"))})})}app.controller("host_change",["$scope","$http",function(e,t){function a(e,a,n,o){$(".special-offer-date-fields").addClass("loading");var i=$("#reservation_code").val();t.post("../rooms/price_calculation",{checkin:a,checkout:e,guest_count:n,room_id:o,change_reservation:i}).then(function(e){$(".special-offer-date-fields").removeClass("loading"),$("#total_price").val(e.data.subtotal)})}setTimeout(function(){var n=e.room_id,o=e.room_id,i=$("#start_date").val(),r=$("#end_date").val();t.post("../rooms/rooms_calendar_alter",{data:n,checkin:i,checkout:r}).then(function(e){var t=(e.data.changed_price,e.data.not_avilable);$("#start_date").datepicker({minDate:0,dateFormat:"dd-mm-yy",setDate:new Date($("#start_date").val()),beforeShowDay:function(e){var e=jQuery.datepicker.formatDate("yy-mm-dd",e);return-1!=$.inArray(e,t)?[!1]:[!0]},onSelect:function(e){var t=$("#start_date").datepicker("getDate");t.setDate(t.getDate()+1),$("#end_date").datepicker("setDate",t),$("#end_date").datepicker("option","minDate",t),setTimeout(function(){$("#end_date").datepicker("show")},20);var n=$(this).val(),t=$("#end_date").val(),i=$("#pricing_guests").val();a(t,n,i,o),e!=new Date&&$(".ui-datepicker-today").removeClass("ui-datepicker-today")}}),jQuery("#end_date").datepicker({minDate:1,dateFormat:"dd-mm-yy",setDate:new Date($("#end_date").val()),beforeShowDay:function(e){var e=jQuery.datepicker.formatDate("yy-mm-dd",e);return-1!=$.inArray(e,t)?[!1]:[!0]},onClose:function(){var e=$("#start_date").datepicker("getDate"),t=$("#end_date").datepicker("getDate");if(e>=t){var n=$("#end_date").datepicker("option","minDate");$("#end_date").datepicker("setDate",n)}var t=$(this).val(),e=$("#start_date").val(),i=$("#pricing_guests").val();""!=e&&a(t,e,i,o)}})}),$("#pricing_guests").change(function(){var e=$(this).val(),t=$("#start_date").val(),n=$("#end_date").val();""!=t&&""!=n&&($(".js-book-it-status").addClass("loading"),a(n,t,e,o))}),$("#property").change(function(){var e=$(this).val(),t=$("#pricing_guests").val(),n=$("#start_date").val(),o=$("#end_date").val();""!=n&&""!=o&&($(".js-book-it-status").addClass("loading"),a(o,n,t,e))})},10),$("#alter-submit-button").click(function(){$("#chage_confirm").attr("aria-hidden","false")}),$("#cancellation-policy-link").click(function(){$("#cancellation_policy").show()}),$("#no_alteration").click(function(){$("#chage_confirm").attr("aria-hidden","true")}),$("#alteration-submit").click(function(){$("#details-form").submit()})}]);