function step(e){$(".frm").hide(),$("#sf"+e).show()}function next(e){v.form()&&(10!=e?($(".frm").hide(),$("#sf"+(e+1)).show()):$("#add_room_form").submit())}function back(e){$(".frm").hide(),$("#sf"+(e-1)).show()}$("#input_dob").datepicker({dateFormat:"dd-mm-yy"});var v=$("#add_room_form").validate({rules:{calendar:{required:!0},bedrooms:{required:!0},beds:{required:!0},bed_type:{required:!0},bathrooms:{required:!0},property_type:{required:!0},room_type:{required:!0},accommodates:{required:!0},name:{required:!0},summary:{required:!0},country:{required:!0},address_line_1:{required:!0},city:{required:!0},state:{required:!0},night:{required:!0,digits:!0},currency_code:{required:!0},"photos[]":{required:!0},cancel_policy:{required:!0},user_id:{required:!0}},errorElement:"span",errorClass:"text-danger"});$(".frm").hide(),$(".frm:first").show(),app.controller("rooms_admin",["$scope","$http","$compile",function(e,t,a){function o(){d=new google.maps.places.Autocomplete(document.getElementById("address_line_1")),d.addListener("place_changed",r)}function r(){n(d.getPlace())}function n(t){var a={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"long_name",country:"short_name",postal_code:"short_name"};$("#city").val(""),$("#state").val(""),$("#country").val(""),$("#address_line_1").val(""),$("#address_line_2").val(""),$("#postal_code").val("");for(var o=t,r=0;r<o.address_components.length;r++){var n=o.address_components[r].types[0];if(a[n]){var d=o.address_components[r][a[n]];"street_number"==n&&(e.street_number=d),"route"==n&&$("#address_line_1").val(d),"postal_code"==n&&$("#postal_code").val(d),"locality"==n&&$("#city").val(d),"administrative_area_level_1"==n&&$("#state").val(d),"country"==n&&$("#country").val(d)}}var i=($("#address_line_1").val(),o.geometry.location.lat()),s=o.geometry.location.lng();""==$("#address_line_1").val()&&$("#address_line_1").val($("#city").val()),""==$("#city").val()&&$("#city").val(""),""==$("#state").val()&&$("#state").val(""),""==$("#postal_code").val()&&$("#postal_code").val(""),$("#latitude").val(i),$("#longitude").val(s)}o();var d;$("#username").autocomplete({source:APP_URL+"/admin/rooms/users_list",select:function(e,t){$("#user_id").val(t.item.id)}}),$(document).on("click",".month-nav",function(){var o=$(this).attr("data-month"),r=$(this).attr("data-year"),n={};n.month=o,n.year=r;var d=JSON.stringify(n);return t.post(APP_URL+"/admin/ajax_calendar/"+$("#room_id").val(),{data:d}).then(function(t){$("#ajax_container").html(a(t.data)(e))}),!1}),$(document).on("change","#calendar_dropdown",function(){var o=$(this).val(),r=o.split("-")[0],n=o.split("-")[1],d={};d.month=n,d.year=r;var i=JSON.stringify(d);return t.post(APP_URL+"/admin/ajax_calendar/"+$("#room_id").val(),{data:i}).then(function(t){$("#ajax_container").html(a(t.data)(e))}),!1}),$(document).on("click",".delete-photo-btn",function(){var e=$(this).attr("data-photo-id");$('[id^="photo_li_"]').size()>1?t.post(APP_URL+"/admin/delete_photo",{photo_id:e}).then(function(t){"true"==t.data.success&&$("#photo_li_"+e).remove()}):alert("You cannnot delete last photo. Please upload alternate photos and delete this photo.")}),$(document).on("keyup",".highlights",function(){var e=$(this).val(),a=$(this).attr("data-photo-id");$("#saved_message").fadeIn(),t.post(APP_URL+"/admin/photo_highlights",{photo_id:a,data:e}).then(function(e){$("#saved_message").fadeOut()})})}]);